#include<iostream>
using namespace std;

/////////////////////////////////////

struct BST{
	int id;
	BST *left = NULL;
	BST *right = NULL;
};

BST *root = NULL;

////////////////////////////////////////////////////////////////////

void insert();
void preorder(BST *p);
void inorder(BST *p);
void postorder(BST *p);
void search(int key, BST *p);
void del(int key);

////////////////////////////////////////////////////////////////////

int opt;
int k;
int key;

////////////////////////////////////////////////////////////////////

int main(){

////////////////////////////////////////////////////////////////////
	
	do{
		
		cout<<"\n\n\t[1]Insert";
		cout<<"\n\t[2]Pre-order";
		cout<<"\n\t[3]In-order";
		cout<<"\n\t[4]Post-order";
		cout<<"\n\t[5]Search";
		cout<<"\n\t[6]Delete leaf node";
		
		cout<<"\n\n\n\tEnter your choice: ";
		cin>>opt;
		
////////////////////////////////////////////////////////////////////		
		
		switch(opt){
//..................................................................			
			case 1:{
				insert();
				break;
			}
			case 2:{
				preorder(root);
				break;
			}
			case 3:{
				inorder(root);
				break;
			}
			case 4:{
				postorder(root);
				break;
			}
			case 5:{
				cout<<"\n\tEnter the key: ";
				cin>>key;
				search(key, root);
				break;
			}
			case 6:{
				int ke;
				cout<<"\n\n\t\tEnter the key: ";
				cin>>ke;
				del(ke);
				break;
			}
//..................................................................			
		}
//..................................................................		
	}
	while(opt != 0);
//..................................................................		
	return 0;
}

////////////////////////////////////////////////////////////////////

void insert(){
	
	BST *curr = new BST;
	
	cout<<"\n\n\tEnter the id: ";
	cin>>curr->id;
//..................................................................	
	if(root == NULL){
		cout<<"\n\n\tTree is empty";
		root = curr;
	}
//..................................................................	
	else{
		BST *p = root;
		BST *p2 = NULL;	//wo node he
		
		while(p != NULL){
//..................................................................			
			p2 = p;
			if(k < p->id){
				p = p->left;
			}
//..................................................................			
			else{
				p = p->right;
			}
//..................................................................			
		}	//yaha par usse node k right/left me null mill jae ga
//..................................................................		
		if(k > p2->id){
			
		p2->right = curr;
		
		}
//..................................................................		
		else{
			
		p2->left = curr;
		
		}
//..................................................................		
	}
//..................................................................	
}

////////////////////////////////////////////////////////////////////
                                     
void preorder(BST *p){
	if(p != NULL){
//..................................................................		
		cout<<"\t"<<p->id<<" ";
		preorder(p->left);
		preorder(p->right);
//..................................................................	
	}
}                                     
                                     
////////////////////////////////////////////////////////////////////

void inorder(BST *p){
	if(p != NULL){
//..................................................................		
		inorder(p->left);
		cout<<"\t"<<p->id<<" ";
		inorder(p->right);
//..................................................................		
	}
}

////////////////////////////////////////////////////////////////////

void postorder(BST *p){
//..................................................................	
	if(p != NULL){
		postorder(p->left);
		postorder(p->right);
		cout<<"\t"<<p->id<<" ";
	}
//..................................................................	
}

////////////////////////////////////////////////////////////////////

void search(int key, BST *p){
//..................................................................		
	if(p == NULL){
		cout<<"\n\n\tNo Tree exists";
	}
//..................................................................		
	else if(p->id == key){
		cout<<"\n\n\tFound";
	}
//..................................................................		
	else if(p->id < key){
			search(key, p->left);
	}
//..................................................................		
	else{
		search(key, p->right);
	}
//..................................................................		
}

void del(int key){
//..................................................................	
	BST *p = root;
	BST *p1 = NULL;
//..................................................................	
	while(p != NULL && p->id != key){
		p1 = p;
		if(p->id == NULL){
			cout<<"\n\n\t\tNo Tree exits";
		}
		else if(key > p->id){
			p = p->right;
		}
		else{
			p = p->left;
		}
		
		if(p->right == NULL && p->left == NULL){
			if(p == p1->left){
				p1->left = NULL;
				delete p;
			}
			else{
				p1->right = NULL;
				delete p;
			}
		}
	}
//..................................................................	
	
}
